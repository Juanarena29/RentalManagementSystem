@using Microsoft.AspNetCore.Components.Authorization
@rendermode InteractiveServer

<AuthorizeView>
    <Authorized>
        <nav class="navbar">
            <div class="navbar-brand">
                <a href="/">CT</a>
            </div>

            <button class="navbar-hamburger" @onclick="ToggleMenu" aria-label="Menu">
                <span></span><span></span><span></span>
            </button>

            <div class="navbar-menu @(_menuAbierto ? "navbar-menu-open" : "")">
                <a href="/" class="navbar-item" @onclick="CerrarMenu">Home</a>

                <div class="navbar-dropdown-wrapper">
                    <span class="navbar-item navbar-has-dropdown">Reservas ▾</span>
                    <div class="navbar-dropdown">
                        <a href="/Reservas/Crear" class="navbar-dropdown-item" @onclick="CerrarMenu">Crear Reserva</a>
                        <a href="/Reservas/Gestion" class="navbar-dropdown-item" @onclick="CerrarMenu">Gestionar</a>
                    </div>
                </div>

                <a href="/Pagos" class="navbar-item" @onclick="CerrarMenu">Pagos</a>
                <a href="/Departamentos" class="navbar-item" @onclick="CerrarMenu">Departamentos</a>
                <a href="/Clientes" class="navbar-item" @onclick="CerrarMenu">Clientes</a>

                <div class="navbar-dropdown-wrapper navbar-end-mobile">
                    <span class="navbar-item navbar-has-dropdown navbar-config">⚙️ @context.User.Identity?.Name ▾</span>
                    <div class="navbar-dropdown navbar-dropdown-right">
                        <a href="/Usuarios" class="navbar-dropdown-item" @onclick="CerrarMenu">Gestionar Usuarios</a>
                        <a href="/CambiarPassword" class="navbar-dropdown-item" @onclick="CerrarMenu">Cambiar
                            Contraseña</a>
                            <hr class="navbar-divider" />
                            <form method="post" action="api/auth/logout">
                                <AntiforgeryToken />
                                <button type="submit" class="navbar-dropdown-item navbar-logout-btn">Cerrar Sesión</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="navbar-end navbar-end-desktop">
                    <div class="navbar-dropdown-wrapper">
                        <span class="navbar-item navbar-has-dropdown navbar-config">⚙️ @context.User.Identity?.Name ▾</span>
                        <div class="navbar-dropdown navbar-dropdown-right">
                            <a href="/Usuarios" class="navbar-dropdown-item">Gestionar Usuarios</a>
                            <a href="/CambiarPassword" class="navbar-dropdown-item">Cambiar Contraseña</a>
                            <hr class="navbar-divider" />
                            <form method="post" action="api/auth/logout">
                                <AntiforgeryToken />
                                <button type="submit" class="navbar-dropdown-item navbar-logout-btn">Cerrar Sesión</button>
                            </form>
                        </div>
                    </div>
                </div>
            </nav>
        </Authorized>
    </AuthorizeView>

@code {
    private bool _menuAbierto = false;

    private void ToggleMenu() => _menuAbierto = !_menuAbierto;
    private void CerrarMenu() => _menuAbierto = false;
}